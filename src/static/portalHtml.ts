export const portalHtml = "<!DOCTYPE html>\r\n<html lang=\"zh-CN\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>äº’ä¸ºå¡å¯†è‡ªåŠ©æ¢ç»‘ä¸­å¿ƒ</title>\r\n    <style>\r\n        :root {\r\n            --bg-color: #0d1117;\r\n            --panel-bg: #161b22;\r\n            --card-bg: #21262d;\r\n            --border-color: #30363d;\r\n            --text-main: #8b949e;\r\n            --text-bright: #c9d1d9;\r\n            --accent: #58a6ff;\r\n            --accent-glow: rgba(88, 166, 255, 0.15);\r\n            --danger: #f85149;\r\n        }\r\n\r\n        body {\r\n            margin: 0;\r\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif;\r\n            background: var(--bg-color);\r\n            color: var(--text-bright);\r\n            line-height: 1.6;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            min-height: 100vh;\r\n        }\r\n\r\n        .container {\r\n            width: 100%;\r\n            max-width: 480px;\r\n            padding: 20px;\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        .card {\r\n            background: var(--panel-bg);\r\n            border: 1px solid var(--border-color);\r\n            border-radius: 12px;\r\n            padding: 32px;\r\n            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n        }\r\n\r\n        .icon {\r\n            width: 48px;\r\n            height: 48px;\r\n            border-radius: 12px;\r\n            background: var(--card-bg);\r\n            border: 1px solid var(--border-color);\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            margin: 0 auto 16px auto;\r\n            font-size: 20px;\r\n        }\r\n\r\n        h1 {\r\n            font-size: 20px;\r\n            font-weight: 600;\r\n            margin: 0 0 8px 0;\r\n            text-align: center;\r\n            color: white;\r\n        }\r\n\r\n        p.desc {\r\n            font-size: 13px;\r\n            color: var(--text-main);\r\n            text-align: center;\r\n            margin-bottom: 24px;\r\n        }\r\n\r\n        .form-group {\r\n            margin-bottom: 16px;\r\n        }\r\n\r\n        input {\r\n            width: 100%;\r\n            padding: 12px 16px;\r\n            background: #0d1117;\r\n            border: 1px solid var(--border-color);\r\n            border-radius: 8px;\r\n            color: var(--text-bright);\r\n            font-size: 14px;\r\n            box-sizing: border-box;\r\n            transition: 0.2s;\r\n        }\r\n\r\n        input:focus {\r\n            border-color: var(--accent);\r\n            box-shadow: 0 0 0 3px var(--accent-glow);\r\n            outline: none;\r\n        }\r\n\r\n        input::placeholder {\r\n            color: #484f58;\r\n        }\r\n\r\n        button {\r\n            width: 100%;\r\n            padding: 12px;\r\n            border-radius: 8px;\r\n            font-weight: 600;\r\n            font-size: 14px;\r\n            cursor: pointer;\r\n            transition: 0.2s;\r\n            border: none;\r\n        }\r\n\r\n        button.primary {\r\n            background: var(--accent);\r\n            color: #0d1117;\r\n        }\r\n\r\n        button.primary:hover {\r\n            opacity: 0.9;\r\n        }\r\n\r\n        button.primary:disabled {\r\n            opacity: 0.5;\r\n            cursor: not-allowed;\r\n        }\r\n\r\n        button.danger {\r\n            background: rgba(248, 81, 73, 0.1);\r\n            color: var(--danger);\r\n            border: 1px solid rgba(248, 81, 73, 0.2);\r\n        }\r\n\r\n        button.danger:hover {\r\n            background: var(--danger);\r\n            color: white;\r\n        }\r\n\r\n        button.btn-aux {\r\n            background: transparent;\r\n            border: 1px solid var(--border-color);\r\n            color: var(--text-bright);\r\n            padding: 4px 8px;\r\n            font-size: 12px;\r\n            width: auto;\r\n        }\r\n\r\n        button.btn-aux:hover {\r\n            background: var(--border-color);\r\n        }\r\n\r\n        .result-area {\r\n            margin-top: 24px;\r\n            display: none;\r\n            border-top: 1px dashed var(--border-color);\r\n            padding-top: 24px;\r\n        }\r\n\r\n        .quota-info {\r\n            font-size: 13px;\r\n            color: var(--text-main);\r\n            margin-bottom: 16px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n        }\r\n\r\n        .device-list {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 8px;\r\n        }\r\n\r\n        .device-item {\r\n            background: #0d1117;\r\n            border: 1px solid var(--border-color);\r\n            border-radius: 8px;\r\n            padding: 16px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n        }\r\n\r\n        .dev-name {\r\n            font-weight: 600;\r\n            font-size: 13px;\r\n            margin-bottom: 4px;\r\n            color: var(--text-bright);\r\n        }\r\n\r\n        .dev-time {\r\n            font-size: 11px;\r\n            color: var(--text-main);\r\n        }\r\n\r\n        .msg {\r\n            padding: 12px;\r\n            border-radius: 8px;\r\n            font-size: 13px;\r\n            margin-bottom: 16px;\r\n            display: none;\r\n            text-align: center;\r\n        }\r\n\r\n        .msg.error {\r\n            background: rgba(248, 81, 73, 0.1);\r\n            color: var(--danger);\r\n            border: 1px solid rgba(248, 81, 73, 0.2);\r\n            display: block;\r\n        }\r\n\r\n        .msg.success {\r\n            background: rgba(63, 185, 80, 0.1);\r\n            color: #3fb950;\r\n            border: 1px solid rgba(63, 185, 80, 0.2);\r\n            display: block;\r\n        }\r\n\r\n        .loading {\r\n            opacity: 0.6;\r\n            pointer-events: none;\r\n        }\r\n\r\n        /* Overlay and Modal */\r\n        .overlay {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            right: 0;\r\n            bottom: 0;\r\n            background: rgba(0, 0, 0, 0.7);\r\n            display: none;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 1000;\r\n        }\r\n\r\n        .modal {\r\n            background: var(--panel-bg);\r\n            border: 1px solid var(--border-color);\r\n            border-radius: 12px;\r\n            width: 90%;\r\n            max-width: 360px;\r\n            padding: 24px;\r\n            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);\r\n            transform: translateY(20px);\r\n            opacity: 0;\r\n            transition: all 0.2s;\r\n        }\r\n\r\n        .overlay.active {\r\n            display: flex;\r\n        }\r\n\r\n        .overlay.active .modal {\r\n            transform: translateY(0);\r\n            opacity: 1;\r\n        }\r\n\r\n        .modal-title {\r\n            font-size: 16px;\r\n            font-weight: 600;\r\n            margin: 0 0 12px 0;\r\n            color: white;\r\n        }\r\n\r\n        .modal-body {\r\n            font-size: 13px;\r\n            color: var(--text-main);\r\n            margin-bottom: 24px;\r\n            line-height: 1.5;\r\n            white-space: pre-wrap;\r\n        }\r\n\r\n        .modal-actions {\r\n            display: flex;\r\n            gap: 12px;\r\n        }\r\n    </style>\r\n</head>\r\n\r\n<body>\r\n    <div class=\"container\">\r\n        <div class=\"card\">\r\n            <div class=\"icon\">ğŸ’»</div>\r\n            <h1>è®¾å¤‡è§£ç»‘æŸ¥è¯¢é—¨æˆ·</h1>\r\n            <p class=\"desc\">åœ¨çº¿å¼ºåˆ¶é‡Šå‡ºä¸å¡å¯†å…³è”çš„å¤±æ•ˆæˆ–é—²ç½®ç‰©ç†è®¾å¤‡</p>\r\n\r\n            <div id=\"sysMsg\" class=\"msg\"></div>\r\n\r\n            <div class=\"form-group\" style=\"position:relative;\">\r\n                <input type=\"text\" id=\"licenseKey\" placeholder=\"è¾“å…¥å®Œæ•´çš„æ¿€æ´»ç å‡­è¯ (License Key)\" autocomplete=\"off\"\r\n                    spellcheck=\"false\" style=\"padding-right: 76px;\" oninput=\"formatLicenseKey(this)\" />\r\n                <div style=\"position:absolute; right:8px; top:50%; transform:translateY(-50%); display:flex; gap:4px;\">\r\n                    <button class=\"secondary btn-aux\" id=\"btnPaste\" onclick=\"pasteKey()\" title=\"ä¸€é”®ç²˜è´´\">ğŸ“‹ ç²˜è´´</button>\r\n                    <button class=\"secondary btn-aux\" id=\"btnClear\" onclick=\"clearKey()\" title=\"æ¸…ç©º\"\r\n                        style=\"display:none; color:var(--text-main);\">âœ•</button>\r\n                </div>\r\n            </div>\r\n            <button class=\"primary\" id=\"btnQuery\" onclick=\"queryDevices()\">ğŸ“¡ æ£€ç´¢é…é¢çŠ¶æ€</button>\r\n\r\n            <div class=\"result-area\" id=\"resultArea\">\r\n                <div class=\"quota-info\">\r\n                    <span>è®¾å¤‡é…é¢ä½¿ç”¨æƒ…å†µ</span>\r\n                    <strong id=\"quotaText\" style=\"color:var(--text-bright)\">- / -</strong>\r\n                </div>\r\n                <div class=\"device-list\" id=\"deviceList\">\r\n                    <!-- devices inject here -->\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"overlay\" id=\"confirmOverlay\">\r\n        <div class=\"modal\">\r\n            <h3 class=\"modal-title\">å±é™©æ“ä½œç¡®è®¤</h3>\r\n            <div class=\"modal-body\" id=\"confirmMsg\"></div>\r\n            <div class=\"modal-actions\">\r\n                <button class=\"secondary\"\r\n                    style=\"background:transparent; border:1px solid var(--border-color); color:var(--text-bright);\"\r\n                    id=\"btnCancelConfirm\">å–æ¶ˆ</button>\r\n                <button class=\"danger\" id=\"btnOkConfirm\">ç¡®å®šæ–­å¼€</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script>\r\n        let currentKey = '';\r\n\r\n        function formatLicenseKey(el) {\r\n            el.value = el.value.replace(/\\s+/g, '').toUpperCase();\r\n            document.getElementById('btnClear').style.display = el.value ? 'block' : 'none';\r\n            document.getElementById('btnPaste').style.display = el.value ? 'none' : 'block';\r\n        }\r\n\r\n        async function pasteKey() {\r\n            try {\r\n                const text = await navigator.clipboard.readText();\r\n                if (text) {\r\n                    const el = document.getElementById('licenseKey');\r\n                    el.value = text;\r\n                    formatLicenseKey(el);\r\n                    // å¯é€‰ï¼šç›´æ¥è§¦å‘æŸ¥è¯¢\r\n                    // queryDevices();\r\n                }\r\n            } catch (err) {\r\n                showMsg('æ— æ³•è®¿é—®å‰ªè´´æ¿æƒé™ï¼Œè¯·é•¿æŒ‰æ‰‹åŠ¨ç²˜è´´');\r\n            }\r\n        }\r\n\r\n        function clearKey() {\r\n            const el = document.getElementById('licenseKey');\r\n            el.value = '';\r\n            formatLicenseKey(el);\r\n            el.focus();\r\n            document.getElementById('resultArea').style.display = 'none';\r\n        }\r\n\r\n        function showConfirm(msg) {\r\n            return new Promise(resolve => {\r\n                const overlay = document.getElementById('confirmOverlay');\r\n                const btnOk = document.getElementById('btnOkConfirm');\r\n                const btnCancel = document.getElementById('btnCancelConfirm');\r\n\r\n                document.getElementById('confirmMsg').innerText = msg;\r\n                overlay.classList.add('active');\r\n\r\n                const cleanup = () => {\r\n                    overlay.classList.remove('active');\r\n                    btnOk.onclick = null;\r\n                    btnCancel.onclick = null;\r\n                };\r\n\r\n                btnOk.onclick = () => { cleanup(); resolve(true); };\r\n                btnCancel.onclick = () => { cleanup(); resolve(false); };\r\n            });\r\n        }\r\n\r\n        function showMsg(text, type = 'error') {\r\n            const el = document.getElementById('sysMsg');\r\n            el.className = 'msg ' + type;\r\n            el.innerText = text;\r\n            setTimeout(() => { el.style.display = 'none'; el.className = 'msg'; }, 5000);\r\n        }\r\n\r\n        async function queryDevices() {\r\n            const key = document.getElementById('licenseKey').value.trim();\r\n            if (!key) return showMsg('è¯·æ‚¨å…ˆè¾“å…¥æœ‰æ•ˆçš„æ¿€æ´»ç å‡­è¯');\r\n\r\n            const btn = document.getElementById('btnQuery');\r\n            btn.classList.add('loading');\r\n            btn.innerText = 'æ­£åœ¨æ£€ç´¢èŠ‚ç‚¹æ•°æ®...';\r\n            document.getElementById('resultArea').style.display = 'none';\r\n\r\n            try {\r\n                const res = await fetch('/api/v1/auth/portal/devices?key=' + encodeURIComponent(key));\r\n                const data = await res.json();\r\n\r\n                if (!data.success) {\r\n                    throw new Error(data.msg || (res.status === 429 ? 'è®¿é—®è¿‡äºé¢‘ç¹ï¼Œè¯·é˜²åˆ·å†·å´åé‡è¯•' : 'æ£€ç´¢å¤±è´¥ï¼Œæ— æ³•ç¡®è®¤å¡å¯†æœ‰æ•ˆæ€§'));\r\n                }\r\n\r\n                currentKey = key;\r\n                renderDevices(data);\r\n            } catch (err) {\r\n                showMsg(err.message);\r\n            } finally {\r\n                btn.classList.remove('loading');\r\n                btn.innerText = 'ğŸ“¡ æ£€ç´¢é…é¢çŠ¶æ€';\r\n            }\r\n        }\r\n\r\n        function renderDevices(data) {\r\n            document.getElementById('resultArea').style.display = 'block';\r\n            let qColor = 'var(--text-bright)';\r\n            if (data.current_devices >= data.max_devices) qColor = 'var(--warning)';\r\n            document.getElementById('quotaText').innerHTML = '<span style=\"color:' + qColor + '\">' + data.current_devices + '</span> / ' + data.max_devices + ' å°';\r\n\r\n            const listEl = document.getElementById('deviceList');\r\n            if (data.devices.length === 0) {\r\n                listEl.innerHTML = '<div style=\"text-align:center; padding: 20px; color: var(--text-main); font-size:12px;\">âœ… å½“å‰æ¿€æ´»ç åä¸‹æ— ä»»ä½•ç‰©ç†è®¾å¤‡ç»‘å®šè®°å½•ï¼Œé¢åº¦å……è¶³ã€‚<br/><br/>æ‚¨å¯ä»¥åœ¨ä»»æ„æœºå™¨ä¸Šç›´æ¥ä½¿ç”¨è¯¥å¡å¯†ï¼</div>';\r\n                return;\r\n            }\r\n\r\n            let html = '';\r\n            data.devices.forEach(d => {\r\n                const date = new Date(d.last_active).toLocaleString();\r\n                html += `<div class=\"device-item\">\r\n                    <div style=\"min-width:0; margin-right:8px;\">\r\n                    <div class=\"dev-name\" title=\"ä¸ºäº†ä¿æŠ¤éšç§ï¼Œå·²æ©ç›–éƒ¨åˆ†åç§°\">${d.device_name}</div>\r\n                    <div class=\"dev-time\">æœ€è¿‘ä½¿ç”¨: ${date}</div>\r\n                    </div>\r\n                    <button class=\"danger\" style=\"width:auto; padding: 6px 12px; font-size: 12px; flex-shrink:0;\" onclick=\"unbindDevice('${d.device_id}')\">æ–­å¼€æˆæƒ</button>\r\n                        </div>`;\r\n            });\r\n            listEl.innerHTML = html;\r\n        }\r\n\r\n        async function unbindDevice(deviceId) {\r\n            const confirmed = await showConfirm('âš ï¸ å±é™©æ“ä½œï¼š\\næ‚¨ç¡®å®šè¦å°†è¿™å°è®¾å¤‡ä»è¯¥æ¿€æ´»ç åä¸‹å¼ºåˆ¶è¸¢å‡ºå—ï¼Ÿè¯¥è®¾å¤‡åŸæœ‰çš„æ‰€æœ‰å†…éƒ¨æˆæƒå°†ç«‹åˆ»æ–­å¼€ï¼');\r\n            if (!confirmed) return;\r\n\r\n            try {\r\n                const res = await fetch('/api/v1/auth/unbind', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({ license_key: currentKey, device_id: deviceId })\r\n                });\r\n                const data = await res.json();\r\n\r\n                if (!data.success) {\r\n                    throw new Error(data.msg || (res.status === 429 ? 'è§£ç»‘é¢‘ç‡è¶…é™ï¼Œé˜²æ¶åˆ·é™åˆ¶æ¿€æ´»ï¼Œè¯·ç¨äº‹ä¼‘æ¯ã€‚' : 'è§£ç»‘é‡åˆ°å¼‚å¸¸æ‹¦æˆª'));\r\n                }\r\n\r\n                showMsg('è®¾å¤‡å·²æˆåŠŸæ–­å¼€é“¾æ¥å¹¶é‡Šå‡ºåé¢ç©ºé—´ï¼', 'success');\r\n                queryDevices(); // refresh the list to verify the vacancy\r\n            } catch (err) {\r\n                showMsg(err.message);\r\n            }\r\n        }\r\n    </script>\r\n</body>\r\n\r\n</html>";